# プレミアム機能・マネタイズ要件書

## 概要

既存のヘルスケア食材アプリに、個人開発レベルで管理可能なプレミアム機能と広告収入モデルを追加する機能の要件定義です。

## 要件

### 要件1: ユーザー認証・サブスクリプション管理

**ユーザーストーリー:** アプリ利用者として、プレミアム機能を利用するためにアカウント作成とサブスクリプション契約ができるようにしたい

#### 受け入れ基準
1. WHEN ユーザーがアカウント作成を行う THEN システムはメールアドレスとパスワードでアカウントを作成する
2. WHEN ユーザーがログインを行う THEN システムは認証情報を検証してセッションを開始する
3. WHEN ユーザーがプレミアムプランに登録する THEN システムはStripe決済を通じてサブスクリプションを作成する
4. WHEN ユーザーがサブスクリプションをキャンセルする THEN システムは次回更新日にプランを無料に変更する

### 要件2: お気に入り機能

**ユーザーストーリー:** プレミアムユーザーとして、気になる食材やレシピを無制限にお気に入り保存して後で確認できるようにしたい

#### 受け入れ基準
1. WHEN プレミアムユーザーが食材詳細ページでお気に入りボタンをクリックする THEN システムはその食材をお気に入りリストに追加する
2. WHEN プレミアムユーザーがレシピでお気に入りボタンをクリックする THEN システムはそのレシピをお気に入りリストに追加する
3. WHEN 無料ユーザーがお気に入りボタンをクリックする THEN システムはプレミアムプランへのアップグレード案内を表示する
4. WHEN プレミアムユーザーがお気に入り一覧ページを表示する THEN システムは保存した全ての食材・レシピを表示する

### 要件3: 検索制限機能

**ユーザーストーリー:** 無料ユーザーとして、月30回までの検索制限があることを理解し、制限に達した場合はプレミアムプランの案内を受けたい

#### 受け入れ基準
1. WHEN 無料ユーザーが検索を実行する THEN システムは検索回数をカウントして残り回数を表示する
2. WHEN 無料ユーザーの検索回数が30回に達する THEN システムは検索を制限してプレミアムプランの案内を表示する
3. WHEN プレミアムユーザーが検索を実行する THEN システムは検索回数の制限なく結果を表示する
4. WHEN 月が変わる THEN システムは無料ユーザーの検索回数をリセットする

### 要件4: 広告表示・非表示機能

**ユーザーストーリー:** 無料ユーザーとして適切な広告を見ることで無料でアプリを利用し、プレミアムユーザーとして広告なしの快適な体験を得たい

#### 受け入れ基準
1. WHEN 無料ユーザーがページを表示する THEN システムは適切な位置に広告を表示する
2. WHEN プレミアムユーザーがページを表示する THEN システムは広告を表示しない
3. WHEN 無料ユーザーが楽天レシピを表示する THEN システムは関連する食材・調理器具の広告を表示する
4. WHEN 広告がクリックされる THEN システムは適切なアフィリエイトリンクに誘導する

### 要件5: 簡易栄養計算機能

**ユーザーストーリー:** プレミアムユーザーとして、選択した食材の合計栄養価を計算して健康管理に役立てたい

#### 受け入れ基準
1. WHEN プレミアムユーザーが複数の食材を選択する THEN システムは合計カロリーを計算して表示する
2. WHEN プレミアムユーザーが栄養計算結果を表示する THEN システムは基本栄養素（タンパク質、炭水化物、脂質）の合計を表示する
3. WHEN プレミアムユーザーが年齢・性別を設定する THEN システムは推奨摂取量との比較を表示する
4. WHEN 無料ユーザーが栄養計算機能にアクセスする THEN システムはプレミアムプランの案内を表示する

### 要件6: PDF保存機能

**ユーザーストーリー:** プレミアムユーザーとして、レシピ情報をPDF形式で保存してオフラインでも確認できるようにしたい

#### 受け入れ基準
1. WHEN プレミアムユーザーがレシピページでPDF保存ボタンをクリックする THEN システムはレシピ情報をPDF形式でダウンロード提供する
2. WHEN プレミアムユーザーがPDF保存時に個人メモを追加する THEN システムはメモを含めたPDFを生成する
3. WHEN 無料ユーザーがPDF保存ボタンをクリックする THEN システムはプレミアムプランの案内を表示する
4. WHEN PDFが生成される THEN システムは読みやすい形式でレシピ情報を整理して表示する

### 要件7: 買い物リスト機能

**ユーザーストーリー:** プレミアムユーザーとして、レシピから必要な食材を買い物リストに追加して効率的に買い物できるようにしたい

#### 受け入れ基準
1. WHEN プレミアムユーザーがレシピページで買い物リストに追加ボタンをクリックする THEN システムは必要な食材を買い物リストに追加する
2. WHEN プレミアムユーザーが買い物リストを表示する THEN システムは追加した食材一覧とチェック機能を提供する
3. WHEN プレミアムユーザーが買い物リストの項目をチェックする THEN システムは完了状態として記録する
4. WHEN 無料ユーザーが買い物リスト機能にアクセスする THEN システムはプレミアムプランの案内を表示する